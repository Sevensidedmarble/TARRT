Based on numerous sources, including the wonderful ROT.JS for Javascript.